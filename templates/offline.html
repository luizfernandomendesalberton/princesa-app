{% extends "base_pwa.html" %}

{% block title %}Offline - Princesa App{% endblock %}

{% block extra_css %}
<style>
.offline-container {
    min-height: 100vh;
    background: linear-gradient(135deg, #ff69b4, #ff1493);
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    color: white;
    padding: 20px;
}

.offline-content {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 20px;
    padding: 40px;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
    border: 1px solid rgba(255, 255, 255, 0.18);
    max-width: 400px;
}

.offline-icon {
    font-size: 4rem;
    margin-bottom: 20px;
    opacity: 0.8;
}

.offline-title {
    font-size: 2rem;
    font-weight: 600;
    margin-bottom: 15px;
    font-family: 'Dancing Script', cursive;
}

.offline-message {
    font-size: 1.1rem;
    margin-bottom: 25px;
    opacity: 0.9;
}

.btn-retry {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    padding: 12px 30px;
    border-radius: 25px;
    font-weight: 500;
    text-decoration: none;
    display: inline-block;
    transition: all 0.3s ease;
}

.btn-retry:hover {
    background: rgba(255, 255, 255, 0.3);
    color: white;
    text-decoration: none;
    transform: translateY(-2px);
}

.sparkle {
    animation: sparkle 2s ease-in-out infinite;
}

@keyframes sparkle {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.2); }
}

.connection-status {
    margin-top: 20px;
    padding: 10px;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.1);
    font-size: 0.9rem;
}

.online {
    background: rgba(46, 204, 113, 0.3);
}

.offline {
    background: rgba(231, 76, 60, 0.3);
}
</style>
{% endblock %}

{% block content %}
<div class="offline-container">
    <div class="offline-content">
        <div class="offline-icon sparkle">
            üå∏
        </div>
        
        <h1 class="offline-title">Ops! Voc√™ est√° offline</h1>
        
        <p class="offline-message">
            N√£o se preocupe, princesa! Algumas funcionalidades ainda funcionam offline. 
            Quando a internet voltar, tudo ser√° sincronizado automaticamente.
        </p>
        
        <a href="javascript:history.back()" class="btn-retry">
            <i class="fas fa-arrow-left"></i> Voltar
        </a>
        
        <button onclick="location.reload()" class="btn-retry" style="margin-left: 10px;">
            <i class="fas fa-sync-alt"></i> Tentar Novamente
        </button>
        
        <div id="connectionStatus" class="connection-status offline">
            <i class="fas fa-wifi"></i> <span id="statusText">Sem conex√£o</span>
        </div>
        
        <div style="margin-top: 20px; font-size: 0.8rem; opacity: 0.7;">
            üí° <strong>Dica:</strong> Instale o app para uma melhor experi√™ncia offline!
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const statusElement = document.getElementById('connectionStatus');
    const statusText = document.getElementById('statusText');
    
    // Verificar status de conex√£o
    function updateConnectionStatus() {
        if (navigator.onLine) {
            statusElement.classList.remove('offline');
            statusElement.classList.add('online');
            statusText.textContent = 'Conectado! Redirecionando...';
            
            // Redirecionar quando voltar online
            setTimeout(() => {
                window.location.href = '/dashboard';
            }, 2000);
        } else {
            statusElement.classList.remove('online');
            statusElement.classList.add('offline');
            statusText.textContent = 'Sem conex√£o';
        }
    }
    
    // Monitorar mudan√ßas de conex√£o
    window.addEventListener('online', updateConnectionStatus);
    window.addEventListener('offline', updateConnectionStatus);
    
    // Verifica√ß√£o inicial
    updateConnectionStatus();
    
    // Verificar periodicamente
    setInterval(updateConnectionStatus, 5000);
});
</script>
{% endblock %}